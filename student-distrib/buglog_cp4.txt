we weren't checking if file offset went beyond the file